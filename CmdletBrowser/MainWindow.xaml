<Window x:Class="CmdletBrowser.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="PowerShell Cmdlet Browser"
        Height="760" Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="#1e1e1e" Foreground="#dddddd"
        FontFamily="Segoe UI"
        Loaded="Window_Loaded">

    <Window.Resources>
        <!-- Dark theme styles -->
        <Style TargetType="TextBlock">
            <Setter Property="Foreground" Value="#dddddd"/>
        </Style>
        <Style TargetType="Label">
            <Setter Property="Foreground" Value="#dddddd"/>
        </Style>
        <Style TargetType="TextBox">
            <Setter Property="Background" Value="#252526"/>
            <Setter Property="Foreground" Value="#dddddd"/>
            <Setter Property="BorderBrush" Value="#3c3c3c"/>
            <Setter Property="CaretBrush" Value="#dddddd"/>
        </Style>
        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="#dddddd"/>
        </Style>
        <Style TargetType="ComboBox">
            <Setter Property="Background" Value="#252526"/>
            <Setter Property="Foreground" Value="#dddddd"/>
        </Style>
        <Style TargetType="Button">
            <Setter Property="Background" Value="#0e639c"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#1177bb"/>
            <Setter Property="Margin" Value="4"/>
            <Setter Property="Padding" Value="6,4"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="1"
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="2">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#1a7fc1"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#0a4f7a"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="DataGrid">
            <Setter Property="Background" Value="#252526"/>
            <Setter Property="Foreground" Value="#dddddd"/>
            <Setter Property="GridLinesVisibility" Value="All"/>
            <Setter Property="HeadersVisibility" Value="All"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#3c3c3c"/>
            <Setter Property="RowBackground" Value="#252526"/>
            <Setter Property="AlternatingRowBackground" Value="#2d2d30"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#3c3c3c"/>
            <Setter Property="VerticalGridLinesBrush" Value="#3c3c3c"/>
        </Style>
        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#2d2d30"/>
            <Setter Property="Foreground" Value="#dddddd"/>
            <Setter Property="BorderBrush" Value="#3c3c3c"/>
            <Setter Property="Padding" Value="6,4"/>
        </Style>
        <Style TargetType="DataGridCell">
            <Setter Property="BorderBrush" Value="#3c3c3c"/>
            <Setter Property="Foreground" Value="#dddddd"/>
        </Style>
        <Style TargetType="TreeView">
            <Setter Property="Background" Value="#252526"/>
            <Setter Property="Foreground" Value="#dddddd"/>
            <Setter Property="BorderBrush" Value="#3c3c3c"/>
        </Style>
        <Style TargetType="TreeViewItem">
            <Setter Property="Foreground" Value="#dddddd"/>
        </Style>
        <Style TargetType="ListView">
            <Setter Property="Background" Value="#252526"/>
            <Setter Property="Foreground" Value="#dddddd"/>
            <Setter Property="BorderBrush" Value="#3c3c3c"/>
        </Style>
        <Style TargetType="GridViewColumnHeader">
            <Setter Property="Background" Value="#2d2d30"/>
            <Setter Property="Foreground" Value="#dddddd"/>
            <Setter Property="BorderBrush" Value="#3c3c3c"/>
            <Setter Property="Padding" Value="6,4"/>
        </Style>
        <Style TargetType="ScrollViewer">
            <Setter Property="Background" Value="#252526"/>
        </Style>
        <Style TargetType="StatusBar">
            <Setter Property="Background" Value="#2d2d30"/>
            <Setter Property="Foreground" Value="#cfcfcf"/>
        </Style>
    </Window.Resources>

    <DockPanel>
        <!-- Top toolbar -->
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="8" Background="#1e1e1e">
            <Label Content="Search:" VerticalAlignment="Center"/>
            <TextBox x:Name="SearchBox" Width="260" VerticalAlignment="Center" Margin="4,0"
                     TextChanged="SearchBox_TextChanged"/>
            <CheckBox x:Name="IncludeFnBox" Content="Include Functions" Margin="16,0" VerticalAlignment="Center"
                      Checked="FilterOption_Changed" Unchecked="FilterOption_Changed"/>
            <CheckBox x:Name="IncludeAlBox" Content="Include Aliases" Margin="12,0" VerticalAlignment="Center"
                      Checked="FilterOption_Changed" Unchecked="FilterOption_Changed"/>
            <Button x:Name="RefreshBtn" Content="Refresh" Click="RefreshBtn_Click"/>
            <Button x:Name="ExportBtn" Content="Export CSV..." Click="ExportBtn_Click"/>
        </StackPanel>

        <!-- Status bar -->
        <StatusBar DockPanel.Dock="Bottom" Background="#2d2d30">
            <StatusBarItem>
                <TextBlock x:Name="StatusText" Text="Ready" Foreground="#cfcfcf"/>
            </StatusBarItem>
        </StatusBar>

        <!-- Main content -->
        <Grid Margin="8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="330"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="240"/>
            </Grid.RowDefinitions>

            <!-- Left: module tree + command list -->
            <Grid Grid.Column="0" Grid.RowSpan="2" Margin="0,0,8,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Border Grid.Row="0" BorderBrush="#3c3c3c" BorderThickness="1" Margin="0,0,0,8">
                    <DockPanel>
                        <TextBlock DockPanel.Dock="Top" Text="Modules" Padding="8" FontWeight="Bold" Background="#2d2d30"/>
                        <TreeView x:Name="ModuleTree" Margin="4"
                                  Background="#252526"
                                  SelectedItemChanged="ModuleTree_SelectedItemChanged"/>
                    </DockPanel>
                </Border>

                <Border Grid.Row="1" BorderBrush="#3c3c3c" BorderThickness="1">
                    <DockPanel>
                        <TextBlock DockPanel.Dock="Top" Text="Commands" Padding="8" FontWeight="Bold" Background="#2d2d30"/>
                        <ListView x:Name="CmdList" Margin="4" BorderThickness="0"
                                  Background="#252526"
                                  SelectionChanged="CmdList_SelectionChanged"
                                  MouseDoubleClick="CmdList_MouseDoubleClick">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Name}" Width="190"/>
                                    <GridViewColumn Header="Module" DisplayMemberBinding="{Binding ModuleName}" Width="120"/>
                                    <GridViewColumn Header="Type" DisplayMemberBinding="{Binding CommandType}" Width="80"/>
                                </GridView>
                            </ListView.View>
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="Foreground" Value="#dddddd"/>
                                    <Setter Property="Background" Value="#252526"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="#094771"/>
                                            <Setter Property="Foreground" Value="White"/>
                                        </Trigger>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#2a2d2e"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </ListView.ItemContainerStyle>
                        </ListView>
                    </DockPanel>
                </Border>
            </Grid>

            <!-- Right Top: help panel -->
            <Grid Grid.Column="1" Grid.Row="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Action bar -->
                <DockPanel Grid.Row="0" Margin="0,0,0,6">
                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Left" VerticalAlignment="Center">
                        <TextBlock Text="Selected: " VerticalAlignment="Center"/>
                        <TextBlock x:Name="SelectedCmdText" FontWeight="Bold" VerticalAlignment="Center" Foreground="#4ec9b0"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Right" HorizontalAlignment="Right">
                        <Button x:Name="CopyNameBtn" Content="Copy Name" Click="CopyNameBtn_Click"/>
                        <Button x:Name="CopySyntaxBtn" Content="Copy Syntax" Click="CopySyntaxBtn_Click"/>
                        <Button x:Name="HelpWindowBtn" Content="Show Help (Window)" Click="HelpWindowBtn_Click"/>
                        <Button x:Name="HelpOnlineBtn" Content="Open Online Help" Click="HelpOnlineBtn_Click"/>
                    </StackPanel>
                </DockPanel>

                <!-- Synopsis + Syntax + Examples -->
                <Grid Grid.Row="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="Synopsis" FontWeight="Bold" Foreground="#9cdcfe"/>
                    <TextBox Grid.Row="1" x:Name="SynopsisBox"
                             IsReadOnly="True" TextWrapping="Wrap"
                             Margin="0,4,0,8" MinHeight="40" MaxHeight="80"/>

                    <Grid Grid.Row="2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <DockPanel Grid.Column="0" Margin="0,0,6,0">
                            <TextBlock DockPanel.Dock="Top" Text="Syntax" FontWeight="Bold"
                                       Margin="0,0,0,4" Foreground="#9cdcfe"/>
                            <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                                <TextBox x:Name="SyntaxBox"
                                         IsReadOnly="True"
                                         FontFamily="Consolas" FontSize="12"
                                         TextWrapping="NoWrap"
                                         AcceptsReturn="True"
                                         Background="#1e1e1e"
                                         Foreground="#ce9178"/>
                            </ScrollViewer>
                        </DockPanel>

                        <DockPanel Grid.Column="1" Margin="6,0,0,0">
                            <TextBlock DockPanel.Dock="Top" Text="Examples" FontWeight="Bold"
                                       Margin="0,0,0,4" Foreground="#9cdcfe"/>
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <TextBox x:Name="ExamplesBox"
                                         IsReadOnly="True"
                                         FontFamily="Consolas" FontSize="12"
                                         TextWrapping="Wrap"
                                         AcceptsReturn="True"
                                         Background="#1e1e1e"
                                         Foreground="#4ec9b0"/>
                            </ScrollViewer>
                        </DockPanel>
                    </Grid>
                </Grid>
            </Grid>

            <!-- Right Bottom: parameters grid -->
            <DockPanel Grid.Column="1" Grid.Row="1" Margin="0,8,0,0">
                <TextBlock DockPanel.Dock="Top" Text="Parameters" FontWeight="Bold"
                           Margin="0,0,0,4" Foreground="#9cdcfe"/>
                <DataGrid x:Name="ParamsGrid"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          IsReadOnly="True"
                          Margin="0,4,0,0">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Name"     Binding="{Binding Name}"     Width="*"/>
                        <DataGridTextColumn Header="Type"     Binding="{Binding Type}"     Width="*"/>
                        <DataGridTextColumn Header="Required" Binding="{Binding Required}" Width="80"/>
                        <DataGridTextColumn Header="Position" Binding="{Binding Position}" Width="80"/>
                        <DataGridTextColumn Header="Pipeline" Binding="{Binding Pipeline}" Width="100"/>
                        <DataGridTextColumn Header="Aliases"  Binding="{Binding Aliases}"  Width="*"/>
                    </DataGrid.Columns>
                    <DataGrid.RowStyle>
                        <Style TargetType="DataGridRow">
                            <Setter Property="Background" Value="#252526"/>
                            <Setter Property="Foreground" Value="#dddddd"/>
                            <Style.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="#094771"/>
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#2a2d2e"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.RowStyle>
                </DataGrid>
            </DockPanel>
        </Grid>
    </DockPanel>
</Window>
